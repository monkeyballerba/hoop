-- âœ… After Library + Utility are loaded...

local Window = Library:CreateWindow({
    Title = "velocity",
    Size = UDim2.new(0, 500, 0, 400),
    Theme = Library.Theme,
    Center = true,
    Draggable = true
})

local MainTab = Window:CreateTab({ Name = "Main UI Settings" })

-- ðŸ€ Shooting Section
local ShootingSection = MainTab:CreateSection({ Name = "Shooting" })
ShootingSection:AddToggle({
    Text = "Auto Green",
    Flag = "AutoGreenEnabled",
    Default = false,
    Callback = function(bool)
        getgenv().AutoGreen = bool
    end
})

-- ðŸ§ª Physics Section
local PhysicsSection = MainTab:CreateSection({ Name = "Physics" })

PhysicsSection:AddSlider({
    Text = "Dribble Glide Speed",
    Flag = "GlideSpeed",
    Min = 10,
    Max = 150,
    Default = 50,
    Float = 1,
    Callback = function(val)
        getgenv().GlideSpeed = val
    end
})

PhysicsSection:AddSlider({
    Text = "Ball Magnet Distance",
    Flag = "MagnetDistance",
    Min = 0,
    Max = 50,
    Default = 0,
    Float = 1,
    Callback = function(val)
        getgenv().MagnetDistance = val
    end
})

-- ðŸŽ® Game Section
local GameSection = MainTab:CreateSection({ Name = "Game" })
GameSection:AddToggle({
    Text = "No Out of Bounds",
    Flag = "NoOutOfBounds",
    Default = false,
    Callback = function(bool)
        getgenv().NoOutOfBounds = bool
    end
})

-- ðŸƒ Stamina Section
local StaminaSection = MainTab:CreateSection({ Name = "Stamina" })
StaminaSection:AddToggle({
    Text = "Auto Sprint",
    Flag = "AutoSprint",
    Default = false
})

StaminaSection:AddToggle({
    Text = "Inf-Stamina",
    Flag = "InfiniteStamina",
    Default = false
})

-- ðŸŒ Global Vars
getgenv().AutoGreen = false
getgenv().GlideSpeed = 50
getgenv().MagnetDistance = 0
getgenv().NoOutOfBounds = false

-- ðŸª‚ Glide key = G
UserInput.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.G then
        local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if root then
            root.Velocity = root.CFrame.LookVector * getgenv().GlideSpeed + Vector3.new(0, 20, 0)
        end
    end
end)

-- ðŸŽ¯ Auto Green Metamethod Hook
local hook
hook = hookmetamethod(game, "__namecall", newcclosure(function(self, ...)
    local args = { ... }
    local method = getnamecallmethod()

    if not checkcaller() and method == "FireServer" and tostring(self) == "Shoot" then
        if getgenv().AutoGreen and args[1] == false then
            args[2] = -0.98
        end
    end

    return hook(self, unpack(args))
end))

-- ðŸ§² Ball Magnet Logic (runs every frame)
RunService.RenderStepped:Connect(function()
    if getgenv().MagnetDistance > 0 then
        local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if root then
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("BasePart") and obj.Name:lower():find("ball") then
                    local dist = (obj.Position - root.Position).Magnitude
                    if dist <= getgenv().MagnetDistance then
                        obj.Velocity = (root.Position - obj.Position).Unit * 100
                    end
                end
            end
        end
    end
end)

-- ðŸš« No Out of Bounds Logic (if needed)
workspace.ChildAdded:Connect(function(child)
    if getgenv().NoOutOfBounds and child.Name:lower():find("outofbounds") then
        wait(0.1)
        child:Destroy()
    end
end)
